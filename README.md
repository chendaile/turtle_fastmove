# Turtle AI Controller

基于ROS2的智能海龟控制系统，使用神经网络和参数优化实现自动路径跟踪。

## 项目概述

本项目实现了基于强化学习和神经网络的海龟控制算法，通过参数优化和性能预测实现最优路径跟踪控制。系统包含三种不同的控制策略实现，用于对比分析不同控制方法的性能表现。

## 文件结构与功能说明

### turtle_ai_controller.py
**主控制器文件 - AI优化控制系统**

本文件实现了完整的智能控制系统，包含以下核心组件：

**optimized_para 类**
- 功能：参数管理与优化
- 关键特性：
  - 管理10个控制参数（角度阈值、转向速度、速度系数等）
  - 实现参数范围约束和随机候选参数生成
  - 提供最佳参数保存与加载功能
- 核心方法：
  - `generate_candidate_params()`: 基于当前参数生成高斯噪声扰动的候选参数
  - `update_params()`: 更新参数并确保在有效范围内
  - `save_best_params()`: 自动保存历史最佳性能参数

**network 类**
- 功能：神经网络性能预测器
- 网络结构：9输入 → 16 → 12 → 8 → 1输出 (全连接层)
- 训练策略：使用最近5圈数据进行反向传播训练
- 预测目标：根据控制参数预测完成一圈所需时间

**turtle_node 类**
- 功能：ROS2节点主控制逻辑
- 控制策略：基于角度差和距离的分层控制
  - 大角度偏差时优先转向调整
  - 小角度偏差时直线前进并微调
  - 接近目标点时执行减速策略
- 优化流程：完成每圈后触发参数优化和神经网络训练

### turtle_NOai_controller.py
**基准控制器文件 - 传统控制方法**

实现基于几何计算的传统控制算法，作为AI控制器的性能对比基准。

**Turtlesim_Speeder 类**
- 功能：基于规则的路径跟踪控制
- 控制逻辑：
  - 计算当前位置到目标点的距离向量和角度偏差
  - 使用阈值判断执行转向或直行策略
  - 基于距离自适应调节前进速度
- 优势：计算简单，无需训练过程
- 局限：参数固定，无法自适应优化

### turtle_keyboard_controller.py
**手动控制器文件 - 人工操作接口**

提供键盘手动控制功能，用于系统测试和人工性能基准建立。

**KeyboardTurtle 类**
- 功能：实时键盘输入处理和运动控制
- 控制映射：w/s控制前后运动，a/d控制左右转向
- 应用场景：
  - 系统功能验证
  - 人工控制性能基准测试
  - 调试和演示

## 算法原理

### 参数优化算法
系统采用基于神经网络预测的参数优化策略：
1. 神经网络学习参数与性能的映射关系
2. 生成多组候选参数并预测其性能
3. 选择预测性能最优的参数组合
4. 更新控制器参数并记录实际性能

### 控制策略
分层控制架构确保路径跟踪的稳定性和效率：
- 角度控制层：优先保证朝向目标的正确性
- 速度控制层：基于距离和角度偏差调节运动速度
- 减速控制层：接近目标时平稳减速以提高精度

## 实验数据

系统运行时输出关键性能指标：
- 圈数完成时间
- 神经网络预测精度
- 参数优化幅度
- 最佳性能记录

最佳参数自动保存至best_params.json文件，支持历史性能分析和参数复用。

## 技术特点

- **自适应性**：通过神经网络学习实现参数自动优化
- **稳定性**：分层控制策略保证路径跟踪稳定性
- **可扩展性**：模块化设计支持控制策略和优化算法扩展
- **可比较性**：提供多种控制方法的性能对比基准

